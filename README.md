# tgSticksFromArchive_bot

![Telegram Bot](https://img.shields.io/badge/Telegram-Bot-blue.svg)
![Python](https://img.shields.io/badge/Python-3.9%2B-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

**tgSticksFromArchive_bot** — это универсальный Telegram-бот, разработанный для управления и создания стикерпаков с легкостью и удобством. Независимо от того, являетесь ли вы заядлым коллекционером стикеров или хотите создать собственные кастомные стикеры, этот бот предоставляет интуитивно понятный интерфейс и мощные функции для упрощения процесса.

## Содержание

- [Особенности](#особенности)
- [Демо](#демо)
- [Установка](#установка)
  - [Предварительные требования](#предварительные-требования)
  - [Шаги установки](#шаги-установки)
  - [Загрузка предобученных моделей](#загрузка-предобученных-моделей)
- [Настройка](#настройка)
- [Использование](#использование)
  - [Команды бота](#команды-бота)
  - [Создание стикерпака](#создание-стикерпака)
  - [Редактирование стикерпака](#редактирование-стикерпака)
  - [Удаление стикерпака](#удаление-стикерпака)
  - [Админ-панель](#админ-панель)
- [Структура проекта](#структура-проекта)
- [Вклад](#вклад)
- [Лицензия](#лицензия)
- [Контакты](#контакты)

## Особенности

- **Управление стикерпаков**
  - Создание новых стикерпаков с уникальными именами и эмодзи.
  - Редактирование существующих стикерпаков, включая переименование и замену стикеров.
  - Удаление стикерпаков без усилий.
  
- **Управление пользователями**
  - Отслеживание взаимодействий пользователей и управление пользовательскими данными.
  - Админ-панель для контроля всех пользователей и их стикерпаков.
  
- **Обработка медиа**
  - Поддержка фотографий и видео, позволяющая добавлять разнообразные медиа в стикерпак.
  - Валидация и обработка медиа-файлов для обеспечения совместимости.
  - Удаление фона с изображений с помощью инструментов BriaAI, RemBG и U2Net.
  - Обработка видео: обрезка до 3 секунд, изменение размера до 512x512 пикселей, конвертация в формат WebM с кодеком VP9.
  
- **Логирование ошибок**
  - Комплексное логирование ошибок для эффективного обслуживания и устранения неполадок.
  
- **Админ-контроль**
  - Расширенная админ-панель для управления пользователями, стикерпаков и контроля доступа.
  - Пагинация для удобной навигации по спискам пользователей и стикерпаков.
  
- **Интеграция с базой данных**
  - Использование SQLite для эффективного хранения и извлечения данных.
  
- **Интерактивный интерфейс**
  - Интуитивно понятные обработчики разговоров, направляющие пользователей через каждый шаг создания и управления стикерпаками.

## Демо

![Демо бота](https://via.placeholder.com/600x400?text=Скриншот+бота)

*Скриншот, демонстрирующий интерфейс и функциональность бота.*

## Установка

### Предварительные требования

- **Python 3.9 или выше**: Убедитесь, что Python установлен на вашем компьютере. Скачать можно [здесь](https://www.python.org/downloads/).
- **Telegram Bot Token**: Создайте нового бота с помощью [BotFather](https://t.me/BotFather) в Telegram, чтобы получить токен вашего бота.
- **FFmpeg**: Установите FFmpeg для обработки видео. Скачать можно [здесь](https://ffmpeg.org/download.html).
- **TensorFlow с поддержкой GPU**: Для ускоренной обработки медиа-файлов рекомендуется установить TensorFlow с поддержкой GPU. Инструкции по установке можно найти [здесь](https://www.tensorflow.org/install/gpu).

### Шаги установки

1. **Клонируйте репозиторий**

   ```bash
   git clone https://github.com/yourusername/tgSticksFromArchive_bot.git
   cd tgSticksFromArchive_bot
   ```

2. **Создайте виртуальное окружение**

   Рекомендуется использовать виртуальное окружение для управления зависимостями.

   ```bash
   python -m venv venv
   source venv/bin/activate  # На Windows: venv\Scripts\activate
   ```

3. **Установите зависимости**

   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте бота**

   - Переименуйте `config_example.py` в `config.py`.

     ```bash
     cp config_example.py config.py
     ```

   - Откройте `config.py` и замените значения-заполнители на ваш реальный токен бота и имя пользователя.

     ```python
     TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"
     BOT_USERNAME = "YourBotUsername_bot"
     ```

5. **Инициализируйте базу данных**

   База данных будет автоматически инициализирована при первом запуске бота.

6. **Загрузка предобученных моделей**

   Для корректной работы функций обработки фотографий необходимо загрузить предобученные модели:

   - **BriaAI**: Скачайте модель с [официального сайта](https://briaai.com/models) и поместите её в директорию `photo/processing/models/briaai/`.
   - **RemBG**: Предобученные модели доступны [здесь](https://github.com/danielgatis/rembg). Скачайте необходимые файлы и разместите их в `photo/processing/models/rembg/`.
   - **U2Net**: Модель U2Net можно скачать с [GitHub репозитория](https://github.com/xuebinqin/U-2-Net). Поместите её в `photo/processing/models/u2net/`.

   Убедитесь, что пути к моделям соответствуют тем, которые используются в коде.

## Настройка

Файл `config.py` содержит основные настройки бота. Убедитесь, что чувствительная информация, такая как токен бота, хранится в безопасности и **никогда** не публикуется публично.

```python
# config.py

TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"
BOT_USERNAME = "YourBotUsername_bot"
```

### Установка TensorFlow с поддержкой GPU

Для оптимальной работы бота рекомендуется установить TensorFlow с поддержкой GPU. Это ускорит процесс обработки медиа-файлов. Следуйте официальным инструкциям по установке [TensorFlow с поддержкой GPU](https://www.tensorflow.org/install/gpu).

Пример установки TensorFlow с поддержкой GPU:

```bash
pip install tensorflow-gpu
```

Убедитесь, что ваша система соответствует требованиям для установки TensorFlow с поддержкой GPU, включая установку необходимых драйверов CUDA и cuDNN.

## Использование

После установки и настройки вы можете запустить бота с помощью следующей команды:

```bash
python main.py
```

### Команды бота

- `/start` — Инициализация взаимодействия с ботом.
- `/help` — Получение помощи и понимание доступных команд.
- `/create` — Начало процесса создания нового стикерпака.
- `/edit` — Редактирование существующего стикерпака.
- `/delete` — Удаление стикерпака.
- `/admin` — Доступ к админ-панели (только для администраторов).

### Создание стикерпака

1. **Запустите бота**

   Отправьте команду `/start`, чтобы начать взаимодействие с ботом.

2. **Выберите действие**

   Выберите `Создать новый стикерпак` из доступных опций.

3. **Предоставьте детали пакета**

   - **Название пакета**: Введите уникальное название для вашего стикерпака (только английские буквы и цифры).
   - **Настройки приватности**: Выберите, будет ли пакет публичным или приватным.
   - **Добавьте стикеры**: Загрузите фотографии или видео для включения в пакет.
   - **Назначьте эмодзи**: Назначьте соответствующие эмодзи каждому стикеру.

4. **Завершите создание**

   Проверьте детали вашего стикерпака и подтвердите его создание.

### Редактирование стикерпака

1. **Выберите `Редактировать стикерпак`**

   Выберите пакет, который вы хотите редактировать, из списка ваших стикерпаков.

2. **Измените детали**

   - **Переименуйте пакет**: Измените название вашего стикерпака.
   - **Замените стикеры**: Обновите существующие стикеры новыми медиа-файлами.
   - **Измените приватность**: Переключитесь между публичными и приватными настройками.

3. **Сохраните изменения**

   Подтвердите и примените ваши модификации.

### Удаление стикерпака

1. **Выберите `Удалить стикерпак`**

   Выберите пакет, который вы хотите удалить, из списка ваших стикерпаков.

2. **Подтвердите удаление**

   Подтвердите удаление выбранного стикерпака.

3. **Удаление**

   Пакет будет удален из вашей коллекции и базы данных.

### Админ-панель

Администраторы могут получить доступ к админ-панели для управления пользователями и стикерпаков:

1. **Доступ к админ-панели**

   Используйте команду `/admin` или выберите `Админ панель` из главного меню.

2. **Управление пользователями**

   - Просмотр списка пользователей.
   - Доступ к стикерпакам конкретных пользователей.

3. **Управление стикерпаками**

   - Просмотр всех стикерпакав.
   - Удаление или изменение любого стикерпака по необходимости.

## Структура проекта

```
tgSticksFromArchive_bot/
├── handlers/
│   ├── admin.py
│   ├── create.py
│   ├── delete.py
│   ├── edit.py
│   ├── start.py
│   └── __init__.py
├── logs/
│   └── ... # Логи ошибок
├── tg_stickers_bot/
│   ├── config.py
│   ├── database.py
│   ├── main.py
│   ├── states.py
│   └── utils.py
├── photo/
│   └── processing/
│       ├── briaai.py
│       ├── rembg.py
│       └── u2net.py
├── user_media/
│   ├── images/
│   │   └── ... # Пользовательские изображения
│   └── videos/
│       └── ... # Пользовательские видео
├── temp/
│   └── ... # Временные файлы
├── requirements.txt
├── README.md
└── LICENSE
```

- **handlers/**: Содержит все модули обработчиков для различных функций бота, включая админские операции.
- **logs/**: Хранит файлы логов для отслеживания ошибок и отладки.
- **tg_stickers_bot/**: Основные компоненты бота, включая конфигурацию, взаимодействие с базой данных, главный скрипт, определения состояний и утилитные функции.
- **photo/processing/**: Модули для обработки изображений, включая удаление фона с использованием BriaAI, RemBG и U2Net.
- **user_media/**: Хранение пользовательских медиа-файлов, разделенных на изображения и видео.
- **temp/**: Временные файлы, созданные во время обработки медиа.
- **requirements.txt**: Список всех зависимостей Python, необходимых для проекта.
- **README.md**: Документационный файл (этот файл).
- **LICENSE**: Информация о лицензии.

## Вклад

Вклад приветствуется! Если вы хотите внести свой вклад в этот проект, пожалуйста, следуйте следующим шагам:

1. **Форк репозитория**

2. **Создайте ветку для фичи**

   ```bash
   git checkout -b feature/YourFeature
   ```

3. **Закоммитьте изменения**

   ```bash
   git commit -m "Добавлена новая фича"
   ```

4. **Запушьте в ветку**

   ```bash
   git push origin feature/YourFeature
   ```

5. **Откройте Pull Request**

   Опишите ваши изменения и отправьте Pull Request для рассмотрения.

## Лицензия

Этот проект лицензирован под [MIT License](LICENSE). Вы можете использовать, изменять и распространять это программное обеспечение в соответствии с условиями лицензии.

## Контакты

Для любых вопросов или поддержки, пожалуйста, свяжитесь со мной:

- **Email**: jsfrau@vk.com
- **Telegram**: [@prikoLlst](https://t.me/prikoLlst)

---
